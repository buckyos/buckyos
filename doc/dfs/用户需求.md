# 站在用户端看到的需求

## 单节点DFS
- 用户可以使用任何已有的技术来创建逻辑磁盘
- 在逻辑磁盘上建立Chunk Bucket并加入到DFS中,建立的时候需要设置Bucket Type,最大大小和保留大小。以及保留剩余空间
- 一个逻辑磁盘智能建立一个Chunk Bucket
- 在逻辑磁盘上建立MetaDB并加入到DFS中。
- DFS可用

## DFS扩容
- DFS可以在运行时加入本机的Bucket
- DFS可以在运行时加入Node:Bucket
- 当DFS加入新节点后，DFS会优先完成MetaDB的分布式化，随后进入“可用，但有数据迁移“的状态
- 等待数据迁移完成，DFS已目标状态正常运行
- DFS会给出当前状态的可靠性/可用性指标，以及迁移后的可靠性/可用性指标


## 手工调整DFS的配置
99%的情况下，系统都是自动生成配置，但我们也允许高级用户手工编辑配置。配置修改后会对系统的可靠性，可用性，性能产生影响
- 修改Bucket的类型 （比如从Storage->Cache)
- 修改某些目录的缓存配置和副本配置
    - 更改写入处理链和读取处理链的逻辑？
- 修改某些目录的编码配置

## DFS的故障修复
- 节点失效: 报告节点实现，并报告对系统可用性/可靠性的影响
    - 是否导致系统进入只读状态
    - 可用性影响：哪些目录不可用（或从读写变成只读）
    - 可靠性影响：哪些数据已经丢失，哪些数据丢失的风险变高
- Bucket（磁盘）失效：
    - 可用性影响：

## 更换故障磁盘 / 节点


## 删除（故障）磁盘/节点

## DFS的数据备份和恢复
- 数据备份首先会建立快照，随后等待外部的备份软件完成备份，该快照被标记为已备份
- 有些快照需要依赖另一个快照，可以看到快照之间的依赖关系
- 可以手工建立一个全量快照。此快照不依赖之前的快照，备份该快照基本相当于备份全部数据
- 快照在备份的时候系统处于 “可用，数据备份中”的状态
- DFS可以选择从任意一个可用的快照恢复。恢复时系统处于 “不可用，数据恢复中”的状态。

## 手工维护友好
- 手工备份/恢复一个bucket
- 
