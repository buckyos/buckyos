#!/bin/bash
set -e
BUCKYOS_ROOT="/opt/buckyos"
DEFAULTS_DIR="$BUCKYOS_ROOT/.buckyos_installer_defaults"

if [ -d "$DEFAULTS_DIR" ]; then
  # BEGIN AUTO-GENERATED: data_paths
  # END AUTO-GENERATED: data_paths
fi

cat <<EOF > /etc/systemd/system/buckyos.service
[Unit]
Description=buckyos node daemon
After=network.target

[Service]
ExecStart=/opt/buckyos/bin/node-daemon/node_daemon --enable_active
User=root
WorkingDirectory=/opt/buckyos/bin
Restart=always

[Install]
WantedBy=multi-user.target
EOF


systemctl stop buckyos.service
systemctl daemon-reload
systemctl enable buckyos.service
systemctl start buckyos.service

chmod -R 777 /opt/buckyos/

echo "BuckyOS install success, open http://127.0.0.1:3182/index.html to start, ENJOY!"
