# Compiled prompt example (from PromptBuilder, simplified):
# [system]
# <<ROLE>>
# ...content from role.md...
# <</ROLE>>
# <<SELF>>
# ...content from self.md...
# <</SELF>>
# <<BEHAVIOR>>
# Handle inbox and event inputs safely.
# Use tools only when needed, keep steps concise, and finish by setting
# next_behavior to "END" when no further action is required.
# <</BEHAVIOR>>
# <<POLICY_SUMMARY>>
# agent.did: did:example:jarvis
# loop.session_id: session-user-1
# step.index: 1
# step.remaining: 7
# <</POLICY_SUMMARY>>
# <<STEP_HINTS>>
# loop.session_id: session-user-1
# loop.event_id: evt-123
# step.index: 1
# step.remaining: 7
# <</STEP_HINTS>>
# <<OUTPUT_PROTOCOL>>
# Return exactly one JSON object and no extra text.
# ... (exactly the text configured in output_protocol.text below) ...
# <</OUTPUT_PROTOCOL>>
# [user]
# <<INBOX>>
# {"trigger":"on_wakeup","router_reply":"收到，先整理项目状态。"}
# <</INBOX>>
# [user]
# <<MEMORY>>
# {"facts":[{"kind":"todo","title":"Reply project status"}]}
# <</MEMORY>>
# [user]
# <<TOOLS>>
# ...tool specs filtered by allow_list...
# <</TOOLS>>
#
# Typical LLM return example (JSON only):
# {
#   "next_behavior": "END",
#   "thinking": "work completed for this wakeup",
#   "reply": [
#     {
#       "audience": "user",
#       "format": "markdown",
#       "content": "已完成本轮处理，项目状态已整理。"
#     }
#   ],
#   "tool_calls": [],
#   "todo": [],
#   "set_memory": [],
#   "actions": [],
#   "session_delta": []
# }

process_rule: |
  Handle inbox and event inputs safely.
  Use tools only when needed, keep steps concise, and finish by setting
  next_behavior to "END" when no further action is required.

output_protocol:
  mode: json_v1
  text: |
    Return exactly one JSON object and no extra text.
    Use this schema:
    {
      "next_behavior": "string|null",
      "thinking": "string|null",
      "reply": [
        {
          "audience": "user|owner|broadcast",
          "format": "markdown|text|json",
          "content": "string"
        }
      ],
      "todo": [],
      "set_memory": [],
      "actions": [{
          "name": "string",
          "args": {},
          "call_id": "string"
        }],
      "session_delta": []
    }
    Use provider-native tool calling protocol when tools are needed.
    Set "next_behavior" to "END" when this wakeup can stop.

tools:
  mode: allow_list
  names:
    - load_memory
    - load_things
    - list
    - todo_manage
    - exec_bash
    - edit_file

limits:
  max_tool_rounds: 3
  max_tool_calls_per_round: 4
  deadline_ms: 60000
